#summary Ensuring data is only accessible to appropriate users.

= Introduction =

As detailed in [http://code.google.com/p/dsn-chassis/issues/detail?id=60 Issue 61] 
the WWARN system must be secured so that only allowed data accesses are possible.

This document describes in natural language the allowed data accesses and 
methods of implementing the required restrictions. 



The access controls are of three types, which can be illustrated as stories: 
 * Role based access to entities: Submitters cannot review submissions
 * Content Type restrictions : Only Atom content-types may be updated, no one may modify an uploaded file
 * Field matching restrictions: Submitters may only alter the studies they have submitted

= Role based access = 

User authentication is provided by the 
== User Roles ==

|| *Role* || *Capabilities* || *Description* ||
|| Surfer || None || Anonymous web user ||
|| Submitter || Creation of data, upload of files || Default role for registered users||
|| Anonymizer || Download of files, Upload of transformed files ||A specialist Curator who reduces identifying data||
|| Curator || Download of files, Upload of transformed files  || Allowed to modify all files||
|| Administrator || Deletion of files, data and users || Super user ||

<br />

= Chassis Atom Entries = 

All Chassis Atom Entries have the following fields: 
Id, Title, Summary, Author list, Date published, Date last updated. 

|| *Name* || *Additional Fields* || *Links*||
|| Study || Module || Edit || 
|| Submission  || <font color="blue">Null</font> || Study, Media+ ||
|| Media  || <font color="blue">Null</font> || Edit, Content.src ||
|| Review || Type, Outcome || Media+ (in)||
|| Derivation || <font color="blue">Null</font> ||  Media+ (in), Media+ (out)||

<br />

= Access levels =

The Access level is defined as one of <font color="blue">Null</font>, 
<font color="red">Create</font>, <font color="green">Read</font>, <font color="red">Update</font> or <font color="red">Delete</font>.

|| || Surfer || Submitter || Anonimiser || Curator || Administrator ||
|| Study || <font color="blue">Null</font> || <font color="red">CRU</font> ||<font color="green">R</font> ||<font color="green">R</font>|| <font color="red">RUD</font> ||
|| Submission || <font color="blue">Null</font> || <font color="red">CR</font> ||<font color="green">R</font> ||<font color="green">R</font>|| <font color="red">RUD</font> ||
|| Media || <font color="blue">Null</font> || <font color="red">CR</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||
|| Resource || <font color="blue">Null</font> || <font color="red">CR</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||
|| Review || <font color="blue">Null</font> || <font color="blue">Null</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||


<br />
= Chassis Collection Query Filters =

All of the above Entries are aggregated into Collections (Atom Feeds). 
The raw collections can only be accessed by *Administrators*.

All other access to the collections is through queries which 
are filtered by the current user and her roles.


Modify means any of Create, Update or Delete, as specified for that user in table above. 


|| || Surfer || Submitter || Anonymizer || Curator || Administrator ||
|| Study || <font color="blue">Null</font> || <font color="red">CRU</font> ||<font color="green">R</font> ||<font color="green">R</font>|| <font color="red">RUD</font> ||
|| Submission || <font color="blue">Null</font> || <font color="red">CR</font> ||<font color="green">R</font> ||<font color="green">R</font>|| <font color="red">RUD</font> ||
|| Media || <font color="blue">Null</font> || <font color="red">CR</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||
|| Review || <font color="blue">Null</font> || <font color="blue">Null</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||
|| Derivation || <font color="blue">Null</font> || <font color="blue">Null</font> ||<font color="red">CR</font> ||<font color="red">CR</font>|| <font color="red">RUD</font> ||

= Content Type Restrictions =

We need to ensure that uploaded files cannot be modified. 
Derivations take as input an uploaded file and output a new uploaded file. 
If a single file is uploaded twice it will still be known as two separate files within Chassis.

The underlying data store (eXist) distinguishes between files which it is concerned with by the files type: it is only interested in files with a content type of <tt>application/xml-atom</tt>

The content type of an Atom PUT request can be determined either from the request content-type property or as a hack by matching the url pattern. 




= Field Matching Restrictions  = 


==References ==
[http://stackoverflow.com/questions/1322135/spring-security-authorization-without-authentication Spring authorization without authentication]