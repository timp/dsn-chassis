#summary access control rules for the data collections in Chassis Manta

= Introduction =

This page describes the access control rules for the data collections in the Chassis Manta product.

Example ACLs are given using the [http://atombeat.org AtomBeat ACL format].


== The /studies Collection ==

E.g., ACL for /studies collection ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">
	<atombeat:acl>

		<!--
			Contributors can list the collection and create members.
		-->  	

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CONTRIBUTOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CONTRIBUTOR</atombeat:recipient>
			<atombeat:permission>CREATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			Personal data reviewers can list the collection and can retrieve any member.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			Curators can list the collection, and can retrieve and update any member.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>UPDATE_MEMBER</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>
</atombeat:security-descriptor>
}}}


== Members of the /studies Collection ==

E.g., ACL for member /studies/ABCDE.atom ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>

		<!--
			By convention, each study is associated with a group of users called "administrators".
		-->

		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS">
			<atombeat:member>suki@example.org</atombeat:member>
		</atombeat:group>

	</atombeat:groups>

	<atombeat:acl>
		
		<!--
			A study administrator can retrieve and update the study, and can retrieve and update the study's permissions.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>UPDATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_ACL</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>UPDATE_ACL</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}


== Submitted Media Collections, e.g., /media/ABCDE/submitted ==

Each study is linked to a submitted media collection. E.g., the study at /studies/ABCDE.atom is linked to its submitted media collection at /media/ABCDE/submitted.

E.g., default ACL for /media/ABCDE/submitted collection ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>

	<atombeat:acl>

		<!--
			The study's administrators can create media resources in the study's submitted media collection, and can list the collection and retrieve and update members (but cannot update media ever, and cannot retrieve media until allowed by personal data reviewer).
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>CREATE_MEDIA</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>UPDATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			Curators can list the collection, and can retrieve any member.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>
		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			Personal data reviewers can list the collection, and can retrieve any member or media resource.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEDIA</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}


== Media Resources in a Submitted Media Collection ==

E.g., default ACL for media resource /media/ABCDE/submitted/XYZ.media (before personal data review) ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>

	<atombeat:acl>

		<!--
			Personal data reviewers can retrieve and update ACLs for media resources (to unlock a media resource which has passed personal data review).
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_ACL</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>UPDATE_ACL</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}

E.g., ACL for media resource /media/ABCDE/submitted/XYZ.media after passed by personal data reviewer ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>

	<atombeat:acl>

		<!--
			Personal data reviewers can retrieve and update ACLs for media resources (to unlock a media resource which has passed personal data review).
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_ACL</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>UPDATE_ACL</atombeat:permission>
		</atombeat:ace>

		<!--
			Study administrators will be allowed to retrieve a media resource if approved by a personal data reviewer.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEDIA</atombeat:permission>
		</atombeat:ace>

		<!--
			Curators will be allowed to retrieve a media resource if approved by a personal data reviewer.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEDIA</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}

I.e., when a personal data reviewer approves a submitted media resource, they must also update the ACL for that media resource to allow curators and the study's administrators to retrieve the media resource.

TODO should this be done via PUT to ACL, or as a side-effect of POSTing the review?


== The /reviews/personal-data Collection ==

E.g., ACL for the /reviews/personal-data collection ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">
	<atombeat:acl>

		<!--
			Personal data reviewers can list the collection and retrieve any member. Only personal data reviewers can create members.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>CREATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_PERSONAL_DATA_REVIEWER</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			Curators can list the collection and retrieve any member.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>
</atombeat:security-descriptor>
}}}


== Members of the /reviews/personal-data Collection ==

E.g., default ACL for member /reviews/personal-data/AAA.atom which reviews a submitted media resource from the study at /studies/ABCDE.atom ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>

	<atombeat:acl>

		<!--
			A study administrator will be permitted to retrieve a review if the review is of a submitted media resource from that study.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}

TODO how does a contributor navigate from a submitted media resource to a personal data review about that media resource? Do we need to add a custom link relation to the media-link entry for the media resource? If so, then we need to add behaviour to the manta atombeat plugin.


== Curated Media Collections, e.g., /media/ABCDE/curated ==

Each study is linked to a curated media collection. E.g., the study at /studies/ABCDE.atom is linked to its curated media collection at /media/ABCDE/curated.

E.g., default ACL for the curated media collection at /media/ABCDE/curated ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">
	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>
	<atombeat:acl>

		<!--
			Curators can create media resources, list the collection, retrieve media resources, and retrieve and update members.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>CREATE_MEDIA</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>UPDATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEDIA</atombeat:permission>
		</atombeat:ace>

		<!--
			The study administrators can list the collection and retrieve members and media resources.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEDIA</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}


== Members of Curated Media Collections ==

Members of a curated media collection need no specific ACL rules, all permissions are covered by the collection ACL.


== Derivations Collections, e.g., /derivations/ABCDE ==

Each study is linked to a derivations collection. E.g., the study at /studies/ABCDE.atom is linked to its derivations collection at /derivations/ABCDE.

E.g., default ACL for the derivations collection at /derivations/ABCDE ...

{{{
<atombeat:security-descriptor xmlns:atombeat="http://atombeat.org/xmlns">

	<atombeat:groups>
		<atombeat:group id="GROUP_STUDY_ADMINISTRATORS" src="http://example.org/chassis/atombeat/content/studies/ABCDE.atom"/>
	</atombeat:groups>

	<atombeat:acl>

		<!--
			Curators can create members, list the collection, and retrieve members.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>CREATE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="role">ROLE_CHASSIS_CURATOR</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

		<!--
			The study administrators can list the collection and retrieve members.
		-->

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>LIST_COLLECTION</atombeat:permission>
		</atombeat:ace>

		<atombeat:ace>
			<atombeat:type>ALLOW</atombeat:type>
			<atombeat:recipient type="group">GROUP_STUDY_ADMINISTRATORS</atombeat:recipient>
			<atombeat:permission>RETRIEVE_MEMBER</atombeat:permission>
		</atombeat:ace>

	</atombeat:acl>

</atombeat:security-descriptor>
}}}

TODO how does user navigate from a curated media resource to its derivation?
