<?xml version="1.0" encoding="UTF-8"?>
<beans:beans 
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
              http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.4.xsd">  



  <!--+
      | 
      | Security requires an authentication provider.
      | For the development environment, we'll import a definition of a simple
      | authentication provider from the classpath.
      | (This file can be found in the generic/lib/java project.)
      |
      +-->
   
  <beans:import resource="classpath:/dev/configuration/spring/authentication-provider.xml"/>



  <!--+
      |
      | Begin definition of HTTP authentication and authorisation rules. 
      |
      +-->
        
  <http 
    auto-config="false" 
    realm="chassis-development-realm" 
    create-session="never"> <!-- N.B. never create sessions, this messes with eXist authentication -->
  
  
    <!--+
        |
        | HTTP authentication mechanisms.
        | For the development environment, use HTTP basic.
        |
        + -->
        
    <http-basic/>


    <!--+
        |
        | Begin HTTP authorisation rules for this Web application.
        |
        +-->
            
    <intercept-url pattern="/submitter/**" access="ROLE_CHASSIS_SUBMITTER" />
    <intercept-url pattern="/anonymizer/**" access="ROLE_CHASSIS_ANONYMIZER" />
    <intercept-url pattern="/curator/**" access="ROLE_CHASSIS_CURATOR" />
    <intercept-url pattern="/administrator/**" access="ROLE_CHASSIS_ADMINISTRATOR" />

    <!--+
        | Temporarily disable these intercepts because abdera is not forwarding
        | cookies properly, and so these intercepts cause any request from abdera
        | to raise a 401 response.
        +-->
      
    <!--
	<intercept-url pattern="/atom/edit/studies" method="POST" access="ROLE_CHASSIS_SUBMITTER" />
	<intercept-url pattern="/atom/edit/studies/**" method="GET" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/studies/**" method="PUT" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/studies/**" method="DELETE" access="ROLE_CHASSIS_ADMINISTRATOR" />

	<intercept-url pattern="/atom/edit/submissions" method="POST" access="ROLE_CHASSIS_SUBMITTER" />
	<intercept-url pattern="/atom/edit/submissions/**" method="GET" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/submissions/**" method="PUT" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/submissions/**" method="DELETE" access="ROLE_CHASSIS_ADMINISTRATOR" />

	<intercept-url pattern="/atom/edit/reviews" method="POST" access="ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR" />
	<intercept-url pattern="/atom/edit/reviews/**" method="GET" access="ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/reviews/**" method="PUT" access="ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/reviews/**" method="DELETE" access="ROLE_CHASSIS_ADMINISTRATOR" />

	<intercept-url pattern="/atom/edit/derivations" method="POST" access="ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ANONYMIZER" />
	<intercept-url pattern="/atom/edit/derivations/**" method="GET" access="ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/derivations/**" method="PUT" access="ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/derivations/**" method="DELETE" access="ROLE_CHASSIS_ADMINISTRATOR" />

	<intercept-url pattern="/atom/edit/media" method="POST" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR" />
	<intercept-url pattern="/atom/edit/media/**" method="GET" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/media/**" method="PUT" access="ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_ANONYMIZER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_ADMINISTRATOR" />
	<intercept-url pattern="/atom/edit/media/**" method="DELETE" access="ROLE_CHASSIS_ADMINISTRATOR" />
    -->
      
  </http>
  
  

</beans:beans>