<?xml version="1.0" encoding="UTF-8"?>
<beans:beans 
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
              http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.4.xsd">  



  <!--+
      | 
      | Security requires an authentication provider.
      |
      +-->
   
  <authentication-provider>
    <user-service id="users">
      <user name="http://localhost/drupal6/?q=user/4/identity" password="notused" authorities="ROLE_CHASSIS_ADMINISTRATOR, ROLE_CHASSIS_SUBMITTER, ROLE_CHASSIS_CURATOR, ROLE_CHASSIS_GATEKEEPER, ROLE_CHASSIS_COORDINATOR" />
    </user-service>
  </authentication-provider>



  <!--+
      |
      | Begin definition of HTTP authentication and authorisation rules. 
      |
      +-->
        
  <http 
    auto-config="false" 
    realm="chassis-development-realm" 
    create-session="never"> <!-- N.B. never create sessions, this messes with eXist authentication -->
  
  
    <!--+
        |
        | HTTP authentication mechanisms.
        | For the development environment, use HTTP basic.
        |
        + -->
        
	<openid-login user-service-ref="users" />
	
	<logout logout-url="/logout"/>

    <!--+
        |
        | Begin HTTP authorisation rules for this Web application.
        |
        +-->
            
    <intercept-url pattern="/spike/**" access="ROLE_CHASSIS_SUBMITTER" />
    <intercept-url pattern="/submitter/**" access="ROLE_CHASSIS_SUBMITTER" />
    <intercept-url pattern="/administrator/**" access="ROLE_CHASSIS_ADMINISTRATOR" />

  </http>
  
  

</beans:beans>