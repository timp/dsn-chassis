<div 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:xforms="http://www.w3.org/2002/xforms" 
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:xi="http://www.w3.org/2001/XInclude">

	<h2>(5) Publications</h2>

	<p>
		<xforms:select1 ref="instance('ins-draft-entry')/atom:content/draft/study-entry-container/atom:entry/atom:content/study/study-is-published">
			<xforms:label>Is the study published?</xforms:label>
			<xforms:item>
				<xforms:value></xforms:value>
				<xforms:label>Select...</xforms:label>
			</xforms:item>
				

            <!-- TODO: factor this out -->
			<xforms:item>
				<xforms:value>true</xforms:value>
				<xforms:label>Yes</xforms:label>
			</xforms:item>
			<xforms:item>
				<xforms:value>false</xforms:value>
				<xforms:label>No</xforms:label>
			</xforms:item>
			
				<!-- 
                    	<xforms:itemset nodeset="instance('ins-study-is-published-terms')/term">
                    		<xforms:label ref="label"/>
                    		<xforms:value ref="value"/>
                    	</xforms:itemset>
                    	
                 -->			
			
		</xforms:select1>
	</p>

    <xforms:group ref="instance('ins-draft-entry')/atom:content/draft/study-entry-container/atom:entry/atom:content/study/publications">
               	
		<table>
            <xforms:repeat nodeset="publication" id="rep-publication">
                <tr>
                    <td>
                        <xforms:trigger>
                            <xforms:delete 
                                ev:event="DOMActivate" 
                                context="." 
                                nodeset="." 
                                at="index('rep-publication')"/>
                            <xforms:label><img src="/apps/contributor/common/remove.gif"/></xforms:label>
                        </xforms:trigger>
                    </td>
                    <td>
                        <xforms:input ref="web-link">
                            <xforms:label>Web Link:</xforms:label>
                            <xforms:alert>Please provide a web link.</xforms:alert>
                        </xforms:input>
                    </td>
                </tr>
            </xforms:repeat>
           <xforms:group ref="instance('ins-control')/add-publication-trigger">
	           <tr>
	                <td>
	                    <xforms:trigger>
	                        <xforms:label><img src="/apps/contributor/common/add.gif"/></xforms:label>
	                        <xforms:insert 
	                            ev:event="DOMActivate" 
	                            context="instance('ins-draft-entry')/atom:content/draft/study-entry-container/atom:entry/atom:content/study/publications" 
	                            nodeset="publication" 
	                            at="last()" 
	                            position="after" 
	                            origin="instance('ins-publication-template')"/>
	                    </xforms:trigger>
	                </td>
	                <td>
	                    <xforms:trigger appearance="minimal">
	                        <xforms:label>Add a Publication</xforms:label>
	                        <xforms:insert 
	                            ev:event="DOMActivate" 
	                            context="instance('ins-draft-entry')/atom:content/draft/study-entry-container/atom:entry/atom:content/study/publications" 
	                            nodeset="publication" 
	                            at="last()" 
	                            position="after" 
	                            origin="instance('ins-publication-template')"/>
	                    </xforms:trigger>
	                </td>
            </tr>
            </xforms:group>
        </table>

	</xforms:group>		

	<p>
	
		<xforms:group ref="instance('ins-control')/save-draft-trigger">
			<xforms:trigger appearance="minimal">
				<xforms:label>&lt;&lt; Back Home</xforms:label>
				<xforms:action ev:event="DOMActivate">
					<xforms:setvalue ref="instance('ins-control')/show-draft-saved-message" value="'no'"/>
					<xforms:send submission="sub-back-home"/>
				</xforms:action>
			</xforms:trigger>
		</xforms:group>		
	
		<xforms:trigger ref="instance('ins-control')/save-draft-trigger">
			<xforms:label>&lt; Previous</xforms:label>
			<xforms:action ev:event="DOMActivate">
				<xforms:setvalue ref="instance('ins-control')/show-draft-saved-message" value="'no'"/>
				<xforms:setvalue ref="instance('ins-draft-entry')/atom:content/draft/wizard-pane-to-show" value="'upload-files'"/>
				<xforms:send submission="sub-put-draft-entry"/>
			</xforms:action>
		</xforms:trigger>

		<xforms:trigger ref="instance('ins-control')/save-draft-trigger">
			<xforms:label>Save As Draft</xforms:label>
			<xforms:action ev:event="DOMActivate">
				<xforms:setvalue ref="instance('ins-control')/show-draft-saved-message" value="'yes'"/>
				<xforms:send submission="sub-put-draft-entry"/>
			</xforms:action>
		</xforms:trigger>

		<xforms:trigger ref="instance('ins-control')/save-draft-trigger">
			<xforms:label>Next &gt;</xforms:label>
			<xforms:action ev:event="DOMActivate">
				<xforms:setvalue ref="instance('ins-control')/show-draft-saved-message" value="'no'"/>
				<xforms:setvalue ref="instance('ins-draft-entry')/atom:content/draft/wizard-pane-to-show" value="'review'"/>
				<xforms:send submission="sub-put-draft-entry" />
			</xforms:action>
		</xforms:trigger>

		<xforms:trigger ref="instance('ins-control')/save-draft-trigger" appearance="minimal">
			<xforms:label>Skip To End &gt;&gt;</xforms:label>
			<xforms:action ev:event="DOMActivate">
				<xforms:setvalue ref="instance('ins-control')/show-draft-saved-message" value="'no'"/>
				<xforms:setvalue ref="instance('ins-draft-entry')/atom:content/draft/wizard-pane-to-show" value="'review'"/>
				<xforms:send submission="sub-put-draft-entry"/>
			</xforms:action>
		</xforms:trigger>
		
	</p>

</div>