<?oxygen NVDLSchema="../../../../../../../../oxygen/samples/nvdl/xhtml-xforms-11-orbeon.nvdl"?>
<div 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:xforms="http://www.w3.org/2002/xforms" 
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:atombeat="http://purl.org/atombeat/xmlns">

    <h2>Administrators</h2>
    
    <xforms:group ref="instance('ins-permissions-entry')//atombeat:security-descriptor/atombeat:groups/atombeat:group[@id='GROUP_ADMINISTRATORS']">
    	
    	<div id="editable-list-of-administrators-container">
    	
		<table>
			<xforms:repeat nodeset="atombeat:member" id="rep-administrator-administrator">
				<tr class="repeated-element">
					<td>
                        <xforms:trigger ref=".">
                        	<xforms:label><img alt="remove" src="/apps/study/common/remove.gif"/></xforms:label>
                        	<xforms:delete 
                            	ev:event="DOMActivate" 
	                        	context="." 
	                        	nodeset="." 
                            	at="index('rep-administrator-administrator')"/>
                        </xforms:trigger>
					</td>
					<td>
						<span class="email-address-textbox-container">
						<xforms:input ref=".">
							<xforms:label>Email address:</xforms:label>
							<xforms:alert>Please provide a valid email address.</xforms:alert>
						</xforms:input>
						</span>
					</td>
				</tr>
			</xforms:repeat>
			<tr>
				<td>
                    <xforms:trigger>
                        <xforms:label><img alt="add" src="/apps/study/common/add.gif"/></xforms:label>
                        <xforms:insert 
	                      	ev:event="DOMActivate" 
	                      	context="." 
	                      	nodeset="atombeat:member" 
	                      	at="last()" 
	                      	position="after" 
	                      	origin="instance('ins-user-template')"/>
                    </xforms:trigger>
				</td>
				<td>
					<span id="add-administrator-link-container">
                    <xforms:trigger appearance="minimal">
                        <xforms:label>Add an Administrator</xforms:label>
                        <xforms:insert 
	                      	ev:event="DOMActivate" 
	                      	context="." 
	                      	nodeset="atombeat:member" 
	                      	at="last()" 
	                      	position="after" 
	                      	origin="instance('ins-user-template')"/>
                    </xforms:trigger>
					</span>
				</td>
			</tr>
		</table>
	
    	</div>

	</xforms:group>
	
     <p>
     	<span id="permissions-save-changes-button-container">
     	<xforms:trigger ref="instance('ins-control')/save-permissions-trigger">
     		<xforms:label>Save Changes</xforms:label>
     		<xforms:action ev:event="DOMActivate" if="../permissions-entry-is-valid = 'true'">
     			<xforms:send submission="sub-put-permissions-entry"/>
     		</xforms:action>
     		<xforms:action ev:event="DOMActivate" if="not(../permissions-entry-is-valid = 'true')">
     			<xforms:message>Please complete all required fields.</xforms:message>
     		</xforms:action>
     	</xforms:trigger>
     	</span>
     </p>
	
</div>