<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>Chassis/* Study Metadata Persistence Service API Specification Version
  0.1-alpha-2-SNAPSHOT</title>
  <link rel="stylesheet" type="text/css"
  href="../../../../style/reset-fonts-grids.css" />
  <link rel="stylesheet" type="text/css" href="../../../../style/base-min.css"
  />
  <link rel="stylesheet" type="text/css"
  href="../../../../style/chassis-docs.css" />
</head>

<body>

<div id="doc">

<div id="hd">
<h1>Chassis/* Submission Metadata Persistence Service<br />
API Specification Version 0.1-alpha-3-SNAPSHOT</h1>

<p>This document defines an API for a web service that provides basic
persistence capabilities (create, retrieve, update, delete) for metadata
records that capture information about data submissions to a data-sharing
network.</p>

<p><strong>This version: <a
href="http://dsn-chassis.googlecode.com/svn/trunk/generic/docs/content/api/service/study/persistence/index.html">0.1-alpha-3-SNAPSHOT</a></strong></p>

<p><strong>Status of This Document</strong></p>

<p>This is not a stable document. This document is a snapshot of the current
development trunk, and is subject to change without notice.</p>

<p><strong>Table of Contents</strong></p>

<div class="toc">
<ul>
  <li><a href="#L55">1. Introduction</a>
    <ul>
      <li><a href="#L59">1.1. Atom Publishing Protocol</a></li>
      <li><a href="#L86">1.2. About This Document</a></li>
      <li><a href="#L933">1.3. Content Types</a></li>
    </ul>
  </li>
  <li><a href="#L100">2. Creating a New Submission Metadata Record</a>
    <ul>
      <li><a href="#L160">2.1. Chassis/* XML Namespace - Submissions</a></li>
    </ul>
  </li>
  <li><a href="#L193">3. Retrieving a Submission Metadata Record</a></li>
  <li><a href="#L208">4. Updating a Submission Metadata Record</a></li>
  <li><a href="#L236">5. Deleting a Submission Metadata Record</a></li>
  <li><a href="#L253">6. Retrieving a Feed of All Submission Metadata
    Records</a></li>
</ul>
</div>
</div>

<div id="bd">
<h2 id="L55">1. Introduction</h2>

<p>This document defines an API for a web service that provides basic
persistence capabilities (create, retrieve, update, delete) for metadata
records that capture information about data submissions to a data-sharing
network.</p>

<h3 id="L59">1.1. Atom Publishing Protocol</h3>

<p>The Chassis/* Submission Metadata Persistence Service API is based on the <a
href="http://www.atomenabled.org/developers/protocol/atom-protocol-spec.php">Atom
Publishing Protocol (AtomPub)</a>. The <a
href="http://code.google.com/apis/gdata/docs/2.0/basics.html">Google Data APIs
Protocol Basics</a> gives an introduction to how Google uses AtomPub, and is a
good introduction to the protocol. See also <a
href="http://code.google.com/p/dsn-chassis/wiki/WhyAtom">WhyAtom</a> for some
discussion of the pros and cons of using AtomPub.</p>

<p>This API is a <strong>content-only extension of AtomPub</strong>. I.e., no
new protocol operations are introduced. The API uses the <a
href="http://www.atomenabled.org/developers/syndication/atom-format-spec.php#extending_atom">extensibility</a>
of the <a
href="http://www.atomenabled.org/developers/syndication/atom-format-spec.php">Atom
Syndication Format</a> to include custom metadata elements into entry
documents. The <a
href="http://www.atomenabled.org/developers/protocol/atom-protocol-spec.php">AtomPub
spec</a> mandates that a conforming processor must store any foreign markup,
thus it is reasonable to expect that all of the operations below would be
supported by any AtomPub implementation.</p>

<h3 id="L86">1.2. About This Document</h3>

<p>The sub-sections below assume that a Submission Metadata Persistence Service
is deployed at:</p>
<ul>
  <li><code>http://example.org/chassis/atom/edit/submissions</code></li>
</ul>

<p>In the <a
href="http://www.atomenabled.org/developers/protocol/atom-protocol-spec.php#terminology">AtomPub
terminology</a>, this URL is the URL of a Collection. Each submission metadata
record becomes an Entry Resource which is a Member of this Collection.</p>

<h3 id="L933">1.3. Content Types</h3>

<p>In the examples below, all responses with content are served with content
type <code>application/atom+xml</code>. Please note that responses may also be
served with content type <code>application/xml</code>.</p>

<h2 id="L100">2. Creating a New Submission Metadata Record</h2>

<p>To create a new submission metadata record, send an HTTP POST request with
an Atom entry document to the service URL.</p>

<p>For example, the request below creates a new submission metadata record.</p>
<pre>POST /chassis/atom/edit/submissions HTTP/1.1
Host: example.org
Content-Type: application/atom+xml;type=entry;charset="utf-8"
Content-Length: nnn

&lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
  &lt;summary&gt;Clinical data for both cases and controls from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
  &lt;author&gt;
    &lt;name&gt;Freda Bloggs&lt;/name&gt;
    &lt;email&gt;freda@example.org&lt;/email&gt;
  &lt;/author&gt;
  &lt;link 
    rel="chassis.study" 
    href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
  &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
  &lt;content type="application/xml"&gt;
    &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
      &lt;module&gt;clinical&lt;/module&gt;  
    &lt;/submission&gt;
  &lt;/content&gt;
&lt;/entry&gt;</pre>

<p>If successful, the response will be <code>201 Created</code>, and should
look something like:</p>
<pre>HTTP/1.1 201 Created
Date: Mon, 06 Jul 2009 11:04:29 GMT
Content-type: application/atom+xml;charset=UTF-8
Location: http://example.org/chassis/atom/edit/submissions?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359

&lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;id&gt;urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359&lt;/id&gt;
  &lt;updated&gt;2009-07-06T12:04:29+01:00&lt;/updated&gt;
  &lt;published&gt;2009-07-06T12:04:29+01:00&lt;/published&gt;
  &lt;link href="?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359" rel="edit" type="application/atom+xml" /&gt;
  &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
  &lt;summary&gt;Clinical data for both cases and controls from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
  &lt;author&gt;
    &lt;name&gt;Freda Bloggs&lt;/name&gt;
    &lt;email&gt;freda@example.org&lt;/email&gt;
  &lt;/author&gt;
  &lt;link 
    rel="chassis.study" 
    href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
  &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
  &lt;content type="application/xml"&gt;
    &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
      &lt;module&gt;clinical&lt;/module&gt;  
    &lt;/submission&gt;
  &lt;/content&gt;
&lt;/entry&gt;</pre>

<p>The absolute URL of the new submission metadata record is given by the value
of the <code>Location</code> header in the HTTP response. The same URL is also
given as a relative URL in the value of the <code>link</code> element
<code>href</code> attribute, where the <code>rel</code> is
<code>edit</code>.</p>

<p>Note that the service will automatically generate an <code>id</code> and
populate the <code>published</code> and <code>updated</code> elements.</p>

<p>The <code>title</code>, <code>summary</code> and <code>author</code>
elements are used from the Atom XML namespace. The <code>author</code> is the
author (i.e., owner) of the metadata record. Any links to study metadata
records are given using the Atom <code>link</code> element with the
<code>rel</code> attribute set to <code>chassis.study</code> (see also the <a
href="@@TODO">Chassis Study Metadata Persistence Service API</a>). The rest of
the submission metadata is given within the <code>content</code> element, using
the Chassis/* XML namespace. </p>

<h3 id="L160">2.1. Chassis/* XML Namespace - Submissions</h3>

<p>The Chassis/* XML namespace defines a set of elements to include within the
<code>submission</code> element, including <code>module</code>. Any other
elements from any other namespace may also be included within the
<code>submission</code> element, providing extensibility for specific
data-sharing networks. The content of the <code>submission</code> element
should conform to the following <a
href="http://www.relaxng.org/compact-tutorial-20030326.html">RelaxNG
schema</a>:</p>
<pre>namespace local = "http://www.cggh.org/2009/chassis/atom/xmlns"

chassisSubmission = 
  element submission {
  ( chassisModule*
  &amp; anyElement* )
} 

chassisModule = element module { xsd:string }</pre>

<h2 id="L193">3. Retrieving a Submission Metadata Record</h2>

<p>To retrieve a previously-created submission metadata record, send an HTTP
GET request to the metadata record URL.</p>

<p>For example, the request below retrieve the metadata record for the
submission created above.</p>
<pre>GET /chassis/atom/edit/submissions?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359 HTTP/1.1
Host: example.org</pre>

<p>If successful, the response will be <code>200 OK</code>, and should look
something like:</p>
<pre>HTTP/1.1 200 OK
Date: Mon, 06 Jul 2009 11:45:53 GMT
Content-Type: application/atom+xml;charset=UTF-8

&lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;id&gt;urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359&lt;/id&gt;
  &lt;updated&gt;2009-07-06T12:04:29+01:00&lt;/updated&gt;
  &lt;published&gt;2009-07-06T12:04:29+01:00&lt;/published&gt;
  &lt;link href="?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359" rel="edit" type="application/atom+xml" /&gt;
  &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
  &lt;summary&gt;Clinical data for both cases and controls from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
  &lt;author&gt;
    &lt;name&gt;Freda Bloggs&lt;/name&gt;
    &lt;email&gt;freda@example.org&lt;/email&gt;
  &lt;/author&gt;
  &lt;link 
    rel="chassis.study" 
    href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
  &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
  &lt;content type="application/xml"&gt;
    &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
      &lt;module&gt;clinical&lt;/module&gt;  
    &lt;/submission&gt;
  &lt;/content&gt;
&lt;/entry&gt;</pre>

<h2 id="L208">4. Updating a Submission Metadata Record</h2>

<p>To update a previously created metadata record, send an HTTP PUT request to
the metadata record URL, containing the updated record.</p>

<p>Below is a request to update the metadata record created above, to amend the
summary. Note that the request does not need to include the <code>id</code>,
<code>published</code> or <code>updated</code> elements, these will be
automatically handled by the service.</p>
<pre>PUT /chassis/atom/edit/submissions?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359 HTTP/1.1
Host: example.org
Content-Type: application/atom+xml;type=entry;charset="utf-8"
Content-Length: nnn

&lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
  &lt;summary&gt;Clinical data for cases only (no controls) from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
  &lt;author&gt;
    &lt;name&gt;Freda Bloggs&lt;/name&gt;
    &lt;email&gt;freda@example.org&lt;/email&gt;
  &lt;/author&gt;
  &lt;link 
    rel="chassis.study" 
    href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
  &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
  &lt;content type="application/xml"&gt;
    &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
      &lt;module&gt;clinical&lt;/module&gt;  
    &lt;/submission&gt;
  &lt;/content&gt;
&lt;/entry&gt;</pre>

<p>If successful, the response should be <code>200 OK</code>, and should look
something like:</p>
<pre>HTTP/1.1 200 OK
Transfer-Encoding: chunked
Date: Mon, 06 Jul 2009 12:51:34 GMT
Content-Type: application/atom+xml;charset=UTF-8
Server: Apache-Coyote/1.1

&lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;id&gt;urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359&lt;/id&gt;
  &lt;updated&gt;2009-07-06T13:51:34+01:00&lt;/updated&gt;
  &lt;published&gt;2009-07-06T12:04:29+01:00&lt;/published&gt;
  &lt;link href="?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359" rel="edit" type="application/atom+xml" /&gt;
  &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
  &lt;summary&gt;Clinical data for cases only (no controls) from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
  &lt;author&gt;
    &lt;name&gt;Freda Bloggs&lt;/name&gt;
    &lt;email&gt;freda@example.org&lt;/email&gt;
  &lt;/author&gt;
  &lt;link 
    rel="chassis.study" 
    href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
  &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
  &lt;content type="application/xml"&gt;
    &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
      &lt;module&gt;clinical&lt;/module&gt;  
    &lt;/submission&gt;
  &lt;/content&gt;
&lt;/entry&gt;</pre>

<p>If your firewall blocks PUT requests, or your client can only perform GET
and POST requests (e.g., GWT), send a POST request with the following header
field:</p>
<pre>X-HTTP-Method-Override: PUT</pre>

<h2 id="L236">5. Deleting a Submission Metadata Record</h2>

<p>To delete a previously created metadata record, send an HTTP DELETE request
to the record URL.</p>

<p>For example, the request below deletes the metadata record created above.</p>
<pre>DELETE /chassis/atom/edit/submissions?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359 HTTP/1.1
Host: example.org</pre>

<p>If successful, the response will be <code>204 No Content</code>.</p>

<p>If your firewall blocks DELETE requests, or your client can only perform GET
and POST requests (e.g., GWT), send a POST request with the following header
field:</p>
<pre>X-HTTP-Method-Override: DELETE</pre>

<h2 id="L253">6. Retrieving a Feed of All Submission Metadata Records</h2>

<p>To retrieve a feed of all submission metadata records held by a submission
metadata persistence service, send an HTTP GET request to the service endpoint
URL.</p>

<p>For example, the request below retrieves a feed of all submission metadata
records from the service.</p>
<pre>GET /chassis/atom/edit/submissions HTTP/1.1
Host: example.org</pre>

<p>If successful, the response will be <code>200 OK</code>, and should look
something like:</p>
<pre>HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: application/atom+xml;charset=UTF-8
Transfer-Encoding: chunked
Date: Mon, 06 Jul 2009 12:56:40 GMT

&lt;feed xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;id&gt;urn:uuid:bbdc13e4-278d-464b-86fb-7e9161383171&lt;/id&gt;
  &lt;updated&gt;2009-07-06T13:51:34+01:00&lt;/updated&gt;
  &lt;title&gt;Submissions&lt;/title&gt;
  &lt;link href="#" rel="edit" type="application/atom+xml"/&gt;
  &lt;link href="#" rel="self" type="application/atom+xml"/&gt;
  &lt;entry xmlns="http://www.w3.org/2005/Atom"&gt;
    &lt;id&gt;urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359&lt;/id&gt;
    &lt;updated&gt;2009-07-06T13:51:34+01:00&lt;/updated&gt;
    &lt;published&gt;2009-07-06T12:04:29+01:00&lt;/published&gt;
    &lt;link href="?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359" rel="edit" type="application/atom+xml" /&gt;
    &lt;title&gt;Clinical Data from Uganda-Kampala-2006&lt;/title&gt;
    &lt;summary&gt;Clinical data for cases only (no controls) from the 2006 study in Kampala, Uganda.&lt;/summary&gt;
    &lt;author&gt;
      &lt;name&gt;Freda Bloggs&lt;/name&gt;
      &lt;email&gt;freda@example.org&lt;/email&gt;
    &lt;/author&gt;
    &lt;link 
      rel="chassis.study" 
      href="http://example.org/chassis/atom/edit/studies?id=urn:uuid:f4070192-c65d-48d7-915f-81d38f61d359"/&gt;
    &lt;category scheme="http://www.cggh.org/2009/chassis/atom/types" term="submission"/&gt;
    &lt;content type="application/xml"&gt;
      &lt;submission xmlns="http://www.cggh.org/2009/chassis/atom/xmlns"&gt;
        &lt;module&gt;clinical&lt;/module&gt;  
      &lt;/submission&gt;
    &lt;/content&gt;
  &lt;/entry&gt;
&lt;/feed&gt;</pre>

<p>In this case, only a single record has been created so far, hence the feed
only contains a single entry.</p>
</div>

<div id="ft">
</div>
</div>
</body>
</html>
