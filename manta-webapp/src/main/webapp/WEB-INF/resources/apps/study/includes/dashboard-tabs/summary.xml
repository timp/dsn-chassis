<?oxygen NVDLSchema="../../../../../../../oxygen/samples/nvdl/xhtml-xforms-11-orbeon.nvdl"?>
<div 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:xforms="http://www.w3.org/2002/xforms"
	xmlns:xxforms="http://orbeon.org/oxf/xml/xforms"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:xi="http://www.w3.org/2001/XInclude">

	<div id="bd" class="clearfix">
		
		<div class="no-bg">
			
			<!-- Help boxes. Comment out if not needed. -->
			<div class="help">
				<xi:include href="../help-boxes/for-dashboard-tabs/for-contributor/summary.xml"/>				
			</div>
			
			
			<div class="main twoCol">
				
				<div id="content" class="study-dashboard">
					
					<h1>Study dashboard - <xforms:output value="instance('ins-study-entry')/atom:title"/> (<xforms:output value="instance('ins-study-entry')/manta:id"/>)</h1>
					
					
						<div class="yui-navset yui-navset-top">
							
							<xi:include href="../dashboard-tabs-menu.xml"/>
							
							
							<div class="yui-content">
							
								<xforms:group ref="instance('ins-study-entry')">
								
									<!-- If the user has GET access to the study entry, but not PUT access. -->
									<xforms:group ref="instance('ins-study-entry')/atom:link[@rel='edit' and contains(@atombeat:allow, 'GET')]">
										<xforms:group ref="instance('ins-study-entry')/atom:link[@rel='edit' and not(contains(@atombeat:allow, 'PUT'))]">
											
									<p>
										<xforms:output ref="instance('ins-study-entry')/atom:title">
											<xforms:label>Title:</xforms:label>
										</xforms:output>	    					
									</p>	
										</xforms:group>
									</xforms:group>
									
									<!-- If the user has GET access to the study entry, and PUT access. -->
									<xforms:group ref="instance('ins-study-entry')/atom:link[@rel='edit' and contains(@atombeat:allow, 'GET')]">
										<xforms:group ref="instance('ins-study-entry')/atom:link[@rel='edit' and (contains(@atombeat:allow, 'PUT'))]">
											
											<p>
												<xforms:input ref="instance('ins-study-entry')/atom:title">
													<xforms:label>Title:</xforms:label>
												</xforms:input>	    					
											</p>
											<h3>Study type (WWARN modules)</h3>
											
											<p>Please select the WWARN modules for which this study has data.</p>
											
											<p>
												<xforms:select ref="instance('ins-study-entry')/atom:content/study/modules" appearance="full">
													<xforms:label>WWARN modules:</xforms:label>
													<xforms:itemset
														nodeset="instance('ins-module-items')/module" class="repeated-element">
														<xforms:label ref="label" />
														<xforms:value ref="value" />
													</xforms:itemset>
													<xforms:alert>Appropriate questions are displayed only when a
														module is selected</xforms:alert>
												</xforms:select>
											</p>
											
										</xforms:group>
									</xforms:group>
										
									<p>
										<xforms:output ref="manta:id">
											<xforms:label>ID:</xforms:label>
										</xforms:output>	    					
									</p>	
									
									<p>
										<xforms:output ref="atom:author/atom:email">
											<xforms:label>Creator:</xforms:label>
										</xforms:output>	    					
									</p>	
									
									<p>
										<xforms:output ref="atom:published" xxforms:format="format-dateTime(., '[Y0001]-[M01]-[D01]')">
											<xforms:label>Terms of Submission accepted:</xforms:label>
										</xforms:output>	    					
									</p>
									
								</xforms:group>

								<xforms:group ref="instance('ins-study-entry')/atom:link[@rel='edit' and (contains(@atombeat:allow, 'PUT'))]">
								<p>
									<span id="title-save-changes-button-container">
										<xforms:trigger ref="instance('ins-control')/save-study-trigger">
											<xforms:label>Save changes</xforms:label>
											<xforms:action ev:event="DOMActivate" if="../study-entry-is-valid = 'true'">
												<xforms:send submission="sub-put-study-entry"/>
											</xforms:action>
											<xforms:action ev:event="DOMActivate" if="not(../study-entry-is-valid = 'true')">
												<xforms:message>Please complete all required fields.</xforms:message>
											</xforms:action>
										</xforms:trigger>
									</span>
								</p>
								</xforms:group>
							
							</div>
							
						</div>

				</div>
			</div>
		</div>
	</div>


</div>		